# Telegram Bot для Booking Assistant

Telegram-бот для взаимодействия пользователей с сервисом записи к мастерам/врачам через MCP-сервер.

## Структура

```
telegram_bot/
├── handlers/             # Обработчики сообщений
│   ├── appointment.py    # Обработка записей
│   ├── commands.py       # Обработка команд
│   ├── registration.py   # Регистрация пользователей
│   └── conversation.py   # Обработка диалога с MCP
├── keyboards/            # Клавиатуры
│   ├── inline.py         # Inline-клавиатуры
│   └── reply.py          # Reply-клавиатуры
├── mcp_client.py         # Клиент для взаимодействия с MCP-сервером
├── config.py             # Конфигурация
├── bot.py                # Основной модуль бота
└── utils.py              # Вспомогательные функции
```

## Установка и запуск

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Настройте переменные окружения:
```bash
export TELEGRAM_BOT_TOKEN=your_bot_token
export MCP_SERVER_URL=http://localhost:5000
```

3. Запустите бота:
```bash
python bot.py
```

## Функции бота

### Команды

- `/start` - Начало взаимодействия с ботом
- `/help` - Получение справки
- `/register` - Регистрация в системе
- `/profile` - Просмотр профиля
- `/specialists` - Список специалистов
- `/services` - Список услуг
- `/appointments` - Мои записи
- `/book` - Записаться на прием
- `/cancel` - Отменить запись

### Возможности

1. **Регистрация и авторизация**
   - Создание профиля клиента
   - Авторизация по номеру телефона

2. **Просмотр информации**
   - Список специалистов и их услуг
   - Информация о конкретном специалисте
   - Прайс-лист услуг

3. **Запись на прием**
   - Выбор специалиста
   - Выбор услуги
   - Выбор даты и времени
   - Подтверждение записи

4. **Управление записями**
   - Просмотр активных записей
   - Отмена записей
   - История посещений

5. **Уведомления**
   - Напоминания о предстоящих записях
   - Уведомления об изменении статуса записи

## Взаимодействие с MCP-сервером

Бот отправляет текстовые сообщения пользователя на MCP-сервер, который обрабатывает их с помощью ИИ и возвращает ответ вместе с рекомендуемыми действиями. Бот выполняет эти действия, формируя соответствующий интерфейс для пользователя.

### Пример взаимодействия:

1. Пользователь отправляет сообщение: "Хочу записаться к стоматологу"
2. Бот отправляет запрос к MCP-серверу
3. MCP-сервер распознает намерение "записаться к специалисту"
4. MCP-сервер возвращает ответ с действием "показать список стоматологов"
5. Бот формирует список стоматологов в виде inline-клавиатуры
6. Пользователь выбирает стоматолога
7. Процесс продолжается до завершения записи 