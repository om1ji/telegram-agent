# Booking Assistant API

API сервис для записи клиентов к мастерам/врачам с интеграцией MCP (Model Context Protocol) для взаимодействия с ИИ-ассистентом через Telegram.

## Структура проекта

Проект состоит из следующих основных компонентов:

1. **Django API** - базовый API для работы с данными
2. **MCP Server** - обертка API для взаимодействия с ИИ-ассистентом 
3. **Telegram Bot** - интерфейс для конечных пользователей

## Модели данных

### Specialist (Специалист)
- `user` - связь с пользователем системы
- `name` - имя специалиста
- `specialization` - специализация
- `description` - описание
- `photo` - фотография
- `is_active` - активен ли специалист
- `city` - город специалиста

### ServiceCategory (Категория услуг)
- `name` - название категории
- `description` - описание категории

### SpecialistSchedule (Расписание специалиста)
- `specialist` - специалист
- `day_of_week` - день недели (0-6)
- `start_time` - время начала работы
- `end_time` - время окончания работы

### Service (Услуга)
- `name` - название услуги
- `description` - описание
- `price` - цена
- `duration` - продолжительность в минутах
- `specialist` - связь со специалистом
- `category` - категория услуги
- `is_active` - активна ли услуга

### Client (Клиент)
- `user` - связь с пользователем системы
- `name` - имя клиента
- `phone` - телефон
- `email` - электронная почта
- `city` - город клиента

### Appointment (Запись)
- `client` - клиент
- `service` - услуга
- `specialist` - специалист
- `date` - дата
- `start_time` - время начала
- `end_time` - время окончания
- `status` - статус (ожидание, подтверждено, завершено, отменено)
- `created_at` - время создания
- `updated_at` - время обновления

## API Endpoints

### Специалисты
- `GET /api/specialists/` - список всех активных специалистов
- `GET /api/specialists/{id}/` - детальная информация о специалисте
- `GET /api/specialists/{id}/services/` - услуги специалиста
- `GET /api/specialists/{id}/schedule/` - расписание специалиста
- `GET /api/specialists/{id}/available_slots/?date=YYYY-MM-DD` - доступные слоты для записи

### Категории услуг
- `GET /api/categories/` - список всех категорий услуг
- `GET /api/categories/{id}/` - детальная информация о категории

### Расписание
- `GET /api/schedules/` - список всех расписаний
- `GET /api/schedules/{id}/` - детальная информация о расписании

### Услуги
- `GET /api/services/` - список всех активных услуг
- `GET /api/services/{id}/` - детальная информация об услуге

### Клиенты
- `GET /api/clients/` - список клиентов (только для администраторов)
- `GET /api/clients/{id}/` - детальная информация о клиенте

### Записи
- `GET /api/appointments/` - список записей
- `GET /api/appointments/{id}/` - детальная информация о записи
- `POST /api/appointments/` - создание новой записи
- `POST /api/appointments/{id}/cancel/` - отмена записи
- `POST /api/appointments/{id}/confirm/` - подтверждение записи
- `POST /api/appointments/{id}/complete/` - завершение записи

## Документация API

API полностью документировано с использованием Swagger/OpenAPI:

- **Swagger UI**: http://localhost:8000/swagger/ - интерактивный интерфейс для просмотра и тестирования API
- **ReDoc**: http://localhost:8000/redoc/ - альтернативный интерфейс для просмотра документации
- **OpenAPI Schema**: http://localhost:8000/swagger.json или http://localhost:8000/swagger.yaml - схема API в формате JSON или YAML

Через Swagger UI вы можете:
- Просматривать все доступные эндпоинты API
- Интерактивно тестировать API, отправляя запросы и просматривая ответы
- Проверять структуру запросов и ответов
- Авторизоваться для тестирования защищенных эндпоинтов

## Интеграция с MCP (Model Context Protocol)

Model Context Protocol будет использоваться для создания интеллектуального интерфейса взаимодействия с API. MCP-сервер будет выполнять следующие функции:

1. Обработка естественного языка для понимания запросов пользователей
2. Трансляция запросов в соответствующие API-вызовы
3. Формирование ответов на запросы пользователей
4. Управление контекстом разговора

## Telegram Bot

Telegram Bot будет выступать в качестве пользовательского интерфейса и предоставлять следующие возможности:

1. Регистрация и авторизация клиентов
2. Просмотр списка специалистов и их услуг
3. Поиск доступных слотов для записи
4. Создание, просмотр и управление записями
5. Уведомления о предстоящих записях
6. Обратная связь после визита

## Установка и запуск

1. Клонируйте репозиторий:
```
git clone <repository_url>
cd boba
```

2. Установите зависимости:
```
pip install -r requirements.txt
```

3. Выполните миграции базы данных:
```
python manage.py migrate
```

4. Создайте суперпользователя:
```
python manage.py createsuperuser
```

5. (Опционально) Создайте тестовые данные:
```
python manage.py create_test_data
```

6. Запустите сервер разработки:
```
python manage.py runserver
```

7. Доступ к API:
   - Административная панель: http://localhost:8000/admin/
   - API: http://localhost:8000/api/
   - Документация API (Swagger UI): http://localhost:8000/swagger/ 